{
  "name": "Service Delivery Model Form",
  "version": "1",
  "published": true,
  "retired": false,
  "pages": [
    {
      "label": "Service Delivery Model",
      "sections": [
        {
          "label": "Introduction",
          "isExpanded": "true",
          "questions": [
            {
              "type": "markdown",
              "questionOptions": {
                "rendering": "markdown"
              },
              "id": "fooMarkdown",
              "value": [
                "**This form is used to:** Document differentiated service delivery enrollment and disenrollment."
              ]
            }
          ]
        },
        {
          "label": "DSD Enrollment",
          "isExpanded": "true",
          "questions": [
            {
              "label": "Date enrolled to DSD",
              "type": "obs",
              "required": true,
              "id": "dateEnrolledToDSD",
              "datePickerFormat": "calendar",
              "questionOptions": {
                "rendering": "date",
                "concept": "160753AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "conceptMappings": [
                  {
                    "relationship": "SAME-AS",
                    "type": "CIEL",
                    "value": "160753"
                  },
                  {
                    "relationship": "SAME-AS",
                    "type": "SNOMED-CT",
                    "value": "439771001"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "unspecified": "true"
                }
              ],
              "validators": [
                {
                  "type": "date",
                  "allowFutureDates": "false"
                },
                {
                  "type": "js_expression",
                  "failsWhenExpression": "isDateBefore(myValue, '1980-01-01') || myValue >= today()"
                }
              ]
            }
          ]
        },
        {
          "label": "DSD Disenrollment (Optional)",
          "isExpanded": "false",
          "questions": [
            {
              "label": "Date disenrolled from DSD",
              "type": "obs",
              "required": false,
              "id": "dateDisenrolledDSD",
              "datePickerFormat": "calendar",
              "questionOptions": {
                "rendering": "date",
                "concept": "166848AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "conceptMappings": [
                  {
                    "relationship": "SAME-AS",
                    "type": "CIEL",
                    "value": "160754"
                  },
                  {
                    "relationship": "SAME-AS",
                    "type": "SNOMED-CT",
                    "value": "439771002"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "unspecified": "true"
                }
              ],
              "validators": [
                {
                  "type": "date",
                  "allowFutureDates": "false"
                },
                {
                  "type": "js_expression",
                  "failsWhenExpression": "isDateBefore(myValue, '1980-01-01') || myValue >= today()"
                },
                {
                  "type": "js_expression",
                  "failsWhenExpression": "!isEmpty(myValue) && !isEmpty(dateEnrolledToDSD) && isDateBefore(myValue, dateEnrolledToDSD)",
                  "message": "Disenrollment date cannot be before enrollment date"
                }
              ]
            },
            {
              "label": "Reason for disenrolling from DSD",
              "type": "obs",
              "required": false,
              "questionOptions": {
                "rendering": "select",
                "concept": "161555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "answers": [
                  {
                    "concept": "159598AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Treatment failure"
                  },
                  {
                    "concept": "5240AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Lost to follow-up"
                  },
                  {
                    "concept": "160432AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Dead"
                  },
                  {
                    "concept": "159492AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Transferred out"
                  },
                  {
                    "concept": "1067AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Unknown"
                  },
                  {
                    "concept": "5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Other"
                  }
                ]
              },
              "id": "reasonForDiscontinuingDSD",
              "behaviours": [
                {
                  "intent": "*",
                  "unspecified": "true"
                }
              ],
              "hide": {
                "hideWhenExpression": "isEmpty(dateDisenrolledDSD)"
              }
            },
            {
              "label": "Other reason (specify)",
              "type": "obs",
              "required": false,
              "questionOptions": {
                "rendering": "text",
                "concept": "160632AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
              },
              "id": "otherReasonDSD",
              "behaviours": [
                {
                  "intent": "*",
                  "unspecified": "true"
                }
              ],
              "hide": {
                "hideWhenExpression": "reasonForDiscontinuingDSD !== '5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA'"
              }
            }
          ]
        },
        {
          "label": "Differentiated Service Delivery Models",
          "isExpanded": "true",
          "questions": [
            {
              "label": "Antiretroviral treatment refill model",
              "type": "obs",
              "required": true,
              "id": "facilityDSDModel",
              "questionOptions": {
                "rendering": "radio",
                "concept": "166448AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "conceptMappings": [
                  {
                    "relationship": "SAME-AS",
                    "type": "KenyaEMR",
                    "value": "164947"
                  },
                  {
                    "relationship": "SAME-AS",
                    "type": "CIEL",
                    "value": "166448"
                  },
                  {
                    "relationship": "NARROWER-THAN",
                    "type": "SNOMED CT",
                    "value": "363819003"
                  }
                ],
                "answers": [
                  {
                    "concept": "166443AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Community medication distribution, healthcare worker led"
                  },
                  {
                    "concept": "166444AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Community medication distribution, peer led"
                  },
                  {
                    "concept": "166446AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Express pharmacy pickup without clinician visit"
                  },
                  {
                    "concept": "166445AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Facility group medication distribution"
                  },
                  {
                    "concept": "166447AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                    "label": "Standard pharmacy pickup following clinician visit"
                  }
                ]
              },
              "behaviours": [
                {
                  "intent": "*",
                  "unspecified": "true"
                }
              ]
            }
          ]
        },
        {
          "label": "Notes",
          "isExpanded": "true",
          "questions": [
            {
              "label": "Comments",
              "type": "obs",
              "questionOptions": {
                "rendering": "textarea",
                "concept": "165095AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA",
                "rows": "4",
                "conceptMappings": [
                  {
                    "type": "CIEL",
                    "value": "165095"
                  }
                ]
              },
              "id": "dSDNotes"
            }
          ]
        }
      ]
    }
  ],
  "availableIntents": [
    {
      "intent": "*",
      "display": "Service Delivery Model"
    }
  ],
  "processor": "EncounterFormProcessor",
  "uuid": "a18228da-832f-4721-a1d7-e70cec50b296",
  "referencedForms": [],
  "encounterType": "62ee5922-a229-48d3-a1da-875c1ffa9436",
  "encounter": "Service Delivery Model Form",
  "allowUnspecifiedAll": true,
  "description": "Document differentiated service delivery enrollment and disenrollment"
}
